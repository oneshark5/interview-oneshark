# Mysql åŸºç¡€

## ä¸€ã€DQL Data Query Language

### 1.1 **åŸºç¡€æŸ¥è¯¢**

è¯­æ³•ï¼š`select æŸ¥è¯¢åˆ—è¡¨ from è¡¨åï¼›`

æŸ¥è¯¢åˆ—è¡¨å¯ä»¥æ˜¯ï¼šè¡¨ä¸­çš„å­—æ®µã€å¸¸é‡ã€è¡¨è¾¾å¼ã€å‡½æ•°ã€‚
æŸ¥è¯¢çš„ç»“æœæ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„è¡¨æ ¼

1. æŸ¥è¯¢è¡¨ä¸­çš„å•ä¸ªå­—æ®µ
    ä¾‹ï¼šselect last_name from employeesï¼›

2. æŸ¥è¯¢è¡¨ä¸­çš„å¤šä¸ªå­—æ®µ
    ä¾‹ï¼šselect last_nameï¼Œsalary from employeesï¼›

3. æŸ¥è¯¢è¡¨ä¸­çš„æ‰€æœ‰å­—æ®µ
    ä¾‹ï¼š select * from è¡¨åï¼›

4. æŸ¥è¯¢å¸¸é‡å€¼
    ä¾‹ï¼šselect 100ï¼›/ select â€˜johnâ€™;

5. æŸ¥è¯¢è¡¨è¾¾å¼
    ä¾‹ï¼šselect 100*98;

6. æŸ¥è¯¢å‡½æ•°
    ä¾‹ï¼šselect version();

7. èµ·åˆ«å
    å¥½å¤„ï¼šä¾¿äºç†è§£ã€å¦‚æœè¦æŸ¥è¯¢çš„å­—æ®µæœ‰é‡åæƒ…å†µï¼Œä½¿ç”¨åˆ«ååŒºåˆ†
    ç”¨ASï¼šselect 10098 **as** ç»“æœï¼›
    çœç•¥ASï¼šselect last_name å§“ï¼›
    åˆ«åä¸­æœ‰å…³é”®å­—ï¼ŒåŠ å¼•å·ï¼Œä¾‹ï¼šselect salary as 'out put' from employeesï¼›

8. å»é‡
    ä¾‹ï¼šæŸ¥è¯¢å‘˜å·¥è¡¨ä¸­æ‰€æœ‰éƒ¨é—¨ç¼–å·

    `select DISTINCT department_id from employees;`

9. +å·çš„ä½œç”¨
    ä»…æœ‰ä¸€ä¸ªåŠŸèƒ½ï¼Œè¿ç®—ç¬¦ã€‚

  ```mysql
    ä¾‹ï¼šselect 100+90ï¼›//190  ä¸¤ä¸ªæ“ä½œæ•°éƒ½ä¸ºæ•°å€¼å‹ï¼ŒåŠ æ³•è¿ç®—ã€‚
    ä¾‹ï¼šselect '100'+90ï¼›//190 å…¶ä¸­ä¸€ä¸ªä¸ºå­—ç¬¦å‹ï¼Œè¯•å›¾å°†å­—ç¬¦å‹è½¬æ¢æˆæ•°å€¼å‹ï¼Œå¦‚æœè½¬æ¢æˆåŠŸï¼Œç»§ç»­åšåŠ æ³•è¿ç®—ã€‚å¦‚æœå¤±è´¥ï¼Œå°†å­—ç¬¦å‹æ•°å€¼è½¬æ¢æˆ0ã€‚ 
    ä¾‹ï¼šselect 'a'+90ï¼›//90
    ä¾‹ï¼šselect null+10ï¼›//null å…¶ä¸­ä¸€æ–¹ä¸ºnullï¼Œç»“æœä¸ºnullã€‚
    ä¾‹ï¼šæŸ¥è¯¢å‘˜å·¥åå’Œå§“ï¼Œå¹¶æ˜¾ç¤ºä¸º å§“åã€‚
    select last_name+first_name as å§“å from employees;//é”™è¯¯æ–¹å¼ï¼Œè¾“å‡º0
  ```

  å¦‚è¦æ‹¼æ¥ï¼Œä½¿ç”¨**concat()**ã€‚

  ```mysql
  select CONCAT( last_name,first_name) as å§“å from employees;//æ­£ç¡®æ–¹å¼
  ```

  **å¦‚concatä¸­æœ‰æŸåˆ—å­˜åœ¨nullå€¼ï¼Œç»“æœä¸ºnullã€‚**
  å¯ä½¿ç”¨**IFNULL**ï¼ˆåˆ—åï¼Œä¸ºnullæ—¶é»˜è®¤å€¼ï¼‰ï¼Œä¸ä¸ºnullæ—¶è¿”å›åŸæœ¬å€¼ã€‚
  **ISNULL** åˆ¤æ–­ç»“æœï¼Œä¸ºtrueè¿”å›1ï¼Œfalseè¿”å›0ã€‚

æ’åºæŸ¥è¯¢

- `order by (asc/desc)`

  ```mysql
   SELECT last_name,salary*12*(1+IFNULL(commission_pct,0)) AS å¹´è–ª FROM employees ORDER BY å¹´è–ª;
  ```

### 1.4å¸¸è§å‡½æ•°

è°ƒç”¨ï¼šselect å‡½æ•°å(å®å‚åˆ—è¡¨) from è¡¨å

- å­—ç¬¦å‡½æ•°

  â‘ **length(str)** è·å–strçš„å­—èŠ‚ä¸ªæ•° ä¸€ä¸ªæ±‰å­—å 3å­—èŠ‚(utf8)
  â‘¡**concat(str1,str2...strn)** æ‹¼æ¥å­—ç¬¦ä¸²
  â‘¢**upper(str)**ã€**lowerï¼ˆstrï¼‰** è½¬æ¢å¤§å°å†™
  â‘£**substr**ã€**substring**è¿”å›å­å­—ç¬¦ä¸²ï¼Œ**SQLä¸­ç´¢å¼•ä»1å¼€å§‹**
  substr(str,n) æˆªå–ä»nå¼€å§‹çš„æ‰€æœ‰å­—ç¬¦
  substr(str,n,m) æˆªå–ä»nå¼€å§‹çš„mä¸ªå­—ç¬¦
  â‘¤**instr(str,substr)** ï¼Œè¿”å›substråœ¨strä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ï¼Œæ²¡æœ‰è¿”å›0ã€‚
  â‘¥**trim(str)**ï¼Œå»æ‰å­—ç¬¦ä¸²ä¸­ç©ºæ ¼ã€‚
  trim(x from str),å»æ‰strå‰åçš„xå­—ç¬¦ã€‚
  â‘¦**lpad(str,n,c)** å·¦å¡«å……ï¼Œç”¨æŒ‡å®šå­—ç¬¦cå¡«å……strå·¦ä¾§è‡³né•¿åº¦ã€‚  

  *rpad(str,n,c)* å³å¡«å……ï¼Œç”¨æŒ‡å®šå­—ç¬¦cå¡«å……strå³ä¾§è‡³né•¿åº¦ã€‚

  â‘§**replace(str,a,b)** æ›¿æ¢

- æ•°å­¦å‡½æ•°

  â‘ **round(x)** å››èˆäº”å…¥
  â‘¡**ceil(x)** å‘ä¸Šå–æ•´ï¼Œè¿”å›å¤§äºç­‰äºå‚æ•°çš„æœ€å°æ•´æ•°
  â‘¢**floor(x)** å‘ä¸‹å–æ•´ï¼Œè¿”å›å°äºç­‰äºå‚æ•°çš„æœ€å¤§æ•´æ•°
  â‘£**truncate(n,m)** æˆªæ–­nï¼Œä¿ç•™mä½
  â‘¤**mod(a,b)** å–ä½™
  â‘¥**rand()** è·å–0-1ä¹‹é—´çš„éšæœºæ•°  

- æ—¥æœŸå‡½æ•°

  â‘ **now()** è¿”å›å½“å‰ç³»ç»Ÿæ—¥æœŸ+æ—¶é—´
  â‘¡**curdate()** è¿”å›å½“å‰æ—¥æœŸ
  â‘¢**curtime()** è¿”å›å½“å‰æ—¶é—´
  â‘£**year(),month(),day(),hour(),minute(),second()** è·å–å¹´æœˆæ—¥æ—¶åˆ†ç§’
  â‘¤**str_to_date()** å°†æ—¥æœŸæ ¼å¼çš„å­—ç¬¦è½¬æ¢æˆæŒ‡å®šæ ¼å¼çš„å­—ç¬¦ä¸²
  â‘¥**date_format()** å°†æ—¥æœŸè½¬æ¢æˆå­—ç¬¦
  â‘¦**datediff()**è¿”å›ä¸¤æ—¥æœŸç›¸å·®çš„å¤©æ•° 

- å…¶ä»–å‡½æ•°

  â‘ **version()** ç‰ˆæœ¬å·
  â‘¡**databases()** æŸ¥çœ‹æ‰€æœ‰[æ•°æ®]()åº“
  â‘¢**user()** å½“å‰ç”¨æˆ·
  â‘£**password(str)** è¿”å›åŠ å¯†å½¢å¼ï¼ˆMySQL8å·²å¼ƒç”¨ï¼‰
  â‘¤**md5(str)** è¿”å›å­—ç¬¦ä¸²çš„md5æ¨¡å¼  

- æµç¨‹æ§åˆ¶å‡½æ•°

  â‘ if (exp1,exp2,exp3)

   è‹¥exp1ä¸ºtrueï¼Œè¿”å›exp2ï¼Œå¦åˆ™è¿”å›exp3

  â‘¡case

  ```mysql
  ç”¨æ³•ä¸€ï¼š
  
   case è¦åˆ¤æ–­çš„å­—æ®µæˆ–è¡¨è¾¾å¼
  
   when å¸¸é‡1 then è¦æ˜¾ç¤ºçš„å€¼ æˆ– è¯­å¥1ï¼›
  
   ...
  
   when å¸¸é‡n then è¦æ˜¾ç¤ºçš„å€¼ æˆ– è¯­å¥nï¼›
  
   else è¦æ˜¾ç¤ºçš„å€¼æˆ–è¯­å¥m
  
   end
  
   ç”¨æ³•äºŒï¼š
  
   case
  
   when æ¡ä»¶1 then è¦æ˜¾ç¤ºçš„å€¼æˆ–è¯­å¥1ï¼›
  
  ...
  
   when æ¡ä»¶n then è¦æ˜¾ç¤ºçš„å€¼ æˆ– è¯­å¥nï¼›
  
   else è¦æ˜¾ç¤ºçš„å€¼æˆ–è¯­å¥m
  
   end
  ```

- *åˆ†ç»„å‡½æ•°**ï¼Œåšç»Ÿè®¡ä½¿ç”¨ï¼Œåˆç§°ç»Ÿè®¡å‡½æ•°æˆ–èšåˆå‡½æ•°***

  **â‘ sum()** æ±‚å’Œ*

  **â‘¡avg()** æ±‚å¹³å‡å€¼

  â‘¢**min()** æ±‚æœ€å°å€¼

  â‘£**max()** æ±‚æœ€å¤§å€¼

  â‘¤**count()** æ±‚éç©ºä¸ªæ•°count(*)/count(å¸¸é‡å€¼) ç»Ÿè®¡æ€»è¡Œæ•°MYISAMå­˜å‚¨å¼•æ“ä¸‹ï¼Œcount(*)æ•ˆç‡é«˜ï¼ŒINNODBä¸‹å·®ä¸å¤šsumå’Œavgå¯¹æ•°å€¼å‹å¤„ç†ï¼Œminå’Œmaxå¯å¯¹å­—ç¬¦å‹å’Œæ—¥æœŸå‹[æ’åº]()æ‰€æœ‰åˆ†ç»„å‡½æ•°éƒ½å¿½ç•¥nullå€¼ï¼Œå¯å’Œdistinctï¼ˆå»é‡ï¼‰æ­é…ä½¿ç”¨
  å’Œåˆ†ç»„å‡½æ•°ä¸€åŒæŸ¥è¯¢çš„å­—æ®µè¦æ±‚æ˜¯group byåçš„å­—æ®µï¼›

### 1.5åˆ†ç»„æŸ¥è¯¢

è¯­æ³•ï¼š

```mysql
select åˆ†ç»„å‡½æ•°ï¼Œåˆ—
from è¡¨å ã€where ç­›é€‰æ¡ä»¶ã€‘
group by åˆ†ç»„åˆ—è¡¨ ã€order by å­—å¥ã€‘
```

ç‰¹ç‚¹ï¼š
åˆ†ç»„å‰ç­›é€‰ [æ•°æ®]()æº  ä¸ºåŸå§‹è¡¨ ç”¨where
åˆ†ç»„åç­›é€‰ [æ•°æ®]()æº  ä¸ºåˆ†ç»„åç»“æœé›† ç”¨having
åˆ†ç»„å‡½æ•°åšæ¡ä»¶è‚¯å®šæ”¾åœ¨havingå­å¥ä¸­
èƒ½ç”¨åˆ†ç»„å‰ç­›é€‰çš„ä¼˜å…ˆè€ƒè™‘åˆ†ç»„å‰ç­›é€‰
group byæ”¯æŒå•ä¸ªå­—æ®µï¼Œå¤šä¸ªå­—æ®µ(ç”¨ï¼Œéš”å¼€)ï¼Œè¡¨è¾¾å¼æˆ–å‡½æ•°åˆ†ç»„ï¼Œä¹Ÿå¯ä»¥æ·»åŠ [æ’åº]()ï¼ˆæ”¾åœ¨æœ€åï¼‰ã€‚  

è¿æ¥æŸ¥è¯¢

åˆç§°å¤šè¡¨æŸ¥è¯¢ï¼Œå½“æŸ¥è¯¢çš„å­—æ®µæ¥è‡ªå¤šä¸ªè¡¨æ—¶ï¼Œä¼šç”¨åˆ°è¿æ¥æŸ¥è¯¢ï¼›
ç¬›å¡å°”ä¹˜ç§¯ï¼šæŸ¥è¯¢å¤šä¸ªè¡¨æ—¶æ²¡æœ‰æ·»åŠ æœ‰æ•ˆçš„è¿æ¥æ¡ä»¶ï¼Œå¯¼è‡´å¤šä¸ªè¡¨å‡ºç°å®Œå…¨è¿æ¥ã€‚å¦‚è¡¨1æœ‰aè¡Œï¼Œè¡¨2æœ‰bè¡Œï¼Œå°†äº§ç”Ÿa*bè¡Œç»“æœã€‚é¿å…ï¼šæ·»åŠ **è¿æ¥æ¡ä»¶**ï¼›

åˆ†ç±»

æŒ‰å¹´ä»£ï¼š
sql92ï¼ˆä»…æ”¯æŒå†…è¿ï¼‰ã€sql99ï¼ˆæ”¯æŒå†…è¿æ¥ã€å·¦å¤–è¿æ¥ã€äº¤å‰è¿æ¥ï¼‰
æŒ‰åŠŸèƒ½ï¼š
å†…è¿æ¥ï¼ˆç­‰å€¼ï¼Œéç­‰å€¼ï¼Œè‡ªç„¶ï¼‰ å¤–è¿æ¥ï¼ˆå·¦ï¼Œå³ï¼Œå…¨ï¼‰ äº¤å‰è¿æ¥

sql92è¯­æ³•

1. **sql92 ç­‰å€¼è¿æ¥**

   ä¾‹ï¼šæŸ¥è¯¢å‘˜å·¥åå’Œå¯¹åº”éƒ¨é—¨å

   ```mysql
   SELECT
       last_name,department_name
   FROM
       employees,departments
   WHERE
       employees.`department_id`=departments.`department_id`;
   ```

   æ³¨æ„ï¼šä¸ºè¡¨èµ·åˆ«ååï¼Œä¸èƒ½ä½¿ç”¨åŸè¡¨åã€‚

2. **sql92 éç­‰å€¼è¿æ¥**

   whereåè·Ÿéç­‰å€¼è¿æ¥æ¡ä»¶

3. **sql92 è‡ªç„¶è¿æ¥**

   æŠŠä¸€å¼ è¡¨é€šè¿‡åˆ«åå½“å¤šè¡¨ä½¿ç”¨

sql99è¯­æ³•

 è¯­æ³•ï¼š

   ```mysql
select æŸ¥è¯¢åˆ—è¡¨
from  è¡¨1 åˆ«å 
è¿æ¥ç±»å‹  join è¡¨2 åˆ«å
on è¿æ¥æ¡ä»¶
...
   ```

1. **å†…è¿æ¥**ï¼š**inner** å¯ä»¥çœç•¥

   - ç­‰å€¼è¿æ¥

     å’Œsql92çš„ç­‰å€¼è¿æ¥æ•ˆæœä¸€æ ·

   - éç­‰å€¼è¿æ¥

   - è‡ªç„¶è¿æ¥

     ä¾‹ï¼šæŸ¥è¯¢å‘˜å·¥åŠå¯¹åº”ä¸Šçº§å

     ```mysql
     SELECT e1.`last_name`,e2.`last_name` 
     FROM  employees e1
     INNER JOIN employees e2 ON e1.`manager_id`=e2.`employee_id`
     ```

     ğŸ¦ˆå†…è¿æ¥åˆ†ä¸ºç­‰å€¼è¿æ¥ã€éç­‰å€¼è¿æ¥å’Œè‡ªç„¶è¿æ¥ï¼Œå…¶ä¸­ç­‰å€¼è¿æ¥ã€éç­‰å€¼è¿æ¥ç›´æ¥åœ¨`where`åé¢æ·»åŠ ç­‰å€¼/éç­‰å€¼æ¡ä»¶å°±å¯ä»¥ï¼Œè‡ªç„¶è¿æ¥åœ¨`INNER JOIN ... ï¼¯ï¼®`åé¢æ·»åŠ æ¡ä»¶ã€‚ã€€ 

2. **å¤–è¿æ¥**ï¼š

   ç”¨äºæŸ¥è¯¢ä¸€ä¸ªè¡¨ä¸­æœ‰ï¼Œå¦ä¸€ä¸ªè¡¨ä¸­æ²¡æœ‰çš„è®°å½•
   ç‰¹ç‚¹ï¼šå¤–è¿æ¥æŸ¥è¯¢çš„ç»“æœä¸ºä¸»è¡¨ä¸­çš„æ‰€æœ‰è®°å½•ï¼Œå¦‚æœä»è¡¨æœ‰å’Œä»–åŒ¹é…çš„åˆ™æ˜¾ç¤ºåŒ¹é…çš„å€¼ï¼Œè‹¥æ²¡æœ‰åˆ™æ˜¾ç¤ºnullã€‚å¤–è¿æ¥æŸ¥è¯¢ç»“æœ=å†…è¿æ¥ç»“æœ+ä¸»è¡¨æœ‰è€Œä»è¡¨æ²¡æœ‰çš„è®°å½•ã€‚
   å·¦å¤–è¿æ¥ä¸­leftå·¦è¾¹çš„æ˜¯ä¸»è¡¨ï¼Œå³å¤–è¿æ¥rightå³è¾¹çš„æ˜¯ä¸»è¡¨ã€‚
   å·¦å¤–å’Œå³å¤–äº¤æ¢é¡ºåºï¼Œå¯å®ç°åŒæ ·çš„æ•ˆæœ  

3. **å·¦å¤–è¿æ¥**ï¼šleft ã€outerã€‘

   åŒ…å«å·¦è¾¹è¡¨çš„å…¨éƒ¨è¡Œï¼ˆä¸ç®¡å³è¾¹çš„è¡¨ä¸­æ˜¯å¦å­˜åœ¨ä¸å®ƒä»¬åŒ¹é…çš„è¡Œï¼‰ï¼Œä»¥åŠå³è¾¹è¡¨ä¸­å…¨éƒ¨åŒ¹é…çš„è¡Œ----ï¼ˆğŸ¦ˆ==ä¸»è¡¨çš„æ‰€æœ‰è¡Œå’Œä»è¡¨ä¸­åŒ¹é…çš„è¡Œ==ï¼‰

   ä¾‹ï¼šæŸ¥è¯¢å“ªä¸ªéƒ¨é—¨æ²¡æœ‰å‘˜å·¥

   ```MYSQL
   SELECT d.*,e.`id` FROM departments d 
   LEFT JOIN employees e ON d.`department_id`=e.`department_id`
   WHERE e.`employee_id` IS NULL
   ```

4. **å³å¤–è¿æ¥**ï¼šrightã€outerã€‘

5. **äº¤å‰è¿æ¥**ï¼šcrossã€outerã€‘

6. **å…¨å¤–è¿æ¥**ï¼šfullã€outerã€‘

   ç­‰äºå†…è¿æ¥çš„ç»“æœ+è¡¨1ä¸­æœ‰è¡¨2ä¸­æ²¡æœ‰çš„+è¡¨2ä¸­æœ‰ä½†è¡¨1ä¸­æ²¡æœ‰çš„

å›¾1 å·¦å¤–è¿æ¥/å†…è¿æ¥/å³å¤–è¿æ¥

![img](mysqlåŸºç¡€.assets/592649258_1575975404617_20191207114645303.jpg)

å›¾2 å·¦å¤–è¿æ¥/å³å¤–è¿æ¥/å…¨å¤–è¿æ¥

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](mysqlåŸºç¡€.assets/592649258_1575975404727_201912071147571.jpg)

sql92å’Œsql99æ¯”è¾ƒ

åŠŸèƒ½ï¼šsql99æ”¯æŒè¾ƒå¤š
å¯è¯»æ€§ï¼šsql99å®ç°è¿æ¥æ¡ä»¶å’Œç­›é€‰æ¡ä»¶çš„åˆ†ç¦»

å­æŸ¥è¯¢

- **å«ä¹‰**ï¼šå‡ºç°åœ¨å…¶ä»–è¯­å¥ä¸­çš„selectè¯­å¥ï¼Œç§°ä¸ºå­æŸ¥è¯¢æˆ–å†…æŸ¥è¯¢å¤–éƒ¨çš„æŸ¥è¯¢è¯­å¥ï¼Œç§°ä¸ºä¸»æŸ¥è¯¢æˆ–å¤–æŸ¥è¯¢ã€‚

- **åˆ†ç±»**ï¼š

  **æŒ‰å­æŸ¥è¯¢å‡ºç°çš„ä½ç½®ï¼š**

  1. `selectåé¢`ä»…æ”¯æŒæ ‡é‡å­æŸ¥è¯¢ï¼›

     æ¡ˆä¾‹ï¼šæŸ¥è¯¢æ¯ä¸ªéƒ¨é—¨çš„å‘˜å·¥ä¸ªæ•°

     ```mysql
     SELECT d.*,(SELECT COUNT(*) FROM employees WHERE employees.`department_id`=d.`department_id`)
     FROM departments d
     ```

  2. **fromåé¢** æ”¯æŒè¡¨å­æŸ¥è¯¢

     æ¡ˆä¾‹ï¼šæŸ¥è¯¢æ¯ä¸ªéƒ¨é—¨çš„å¹³å‡å·¥èµ„çš„å·¥èµ„ç­‰çº§

     ```mysql
     SELECT t1.*,t2.`grade_level`
     FROM(
         SELECT department_id,AVG(salary) avg_salary FROM employees
         GROUP BY department_id
     ) t1 INNER JOIN job_grades t2
     ON t1.avg_salary BETWEEN t2.`lowest_sal` AND t2.`highest_sal`
     ```

     å°†å­æŸ¥è¯¢ç»“æœå……å½“ä¸€å¼ è¡¨ï¼Œè¦æ±‚å¿…é¡»èµ·åˆ«å

  3. **whereæˆ–havingåé¢** **â­**

     ç‰¹ç‚¹ï¼šå­æŸ¥è¯¢éƒ½æ”¾åœ¨å°æ‹¬å·å†…ã€å­æŸ¥è¯¢æ”¾åœ¨æ¡ä»¶å³ä¾§ã€æ ‡é‡å­æŸ¥è¯¢æ­é…å•è¡Œæ“ä½œç¬¦ï¼ˆ>, <, >=, <=, =, <>ï¼‰ã€åˆ—å­æŸ¥è¯¢æ­é…å¤šè¡Œæ“ä½œç¬¦ï¼ˆin/not in,any/some,allï¼‰ã€å­æŸ¥è¯¢çš„æ‰§è¡Œä¼˜å…ˆäºä¸»æŸ¥è¯¢æ‰§è¡Œï¼Œä¸»æŸ¥è¯¢çš„æ¡ä»¶ç”¨åˆ°äº†å­æŸ¥è¯¢çš„ç»“æœ  

     â‘ æ”¯æŒæ ‡é‡å­æŸ¥è¯¢ï¼ˆå•è¡Œï¼‰
     æ¡ˆä¾‹ï¼šè°çš„å·¥èµ„æ¯”abelé«˜?

     ```mysql
     SELECT e.`last_name` FROM employees e WHERE e.`salary`>(SELECT salary FROM employees WHERE last_name = 'Abel')ï¼›
     ```

     â‘¡åˆ—å­æŸ¥è¯¢ï¼ˆå¤šè¡Œï¼‰
     æ¡ˆä¾‹ï¼šæŸ¥è¯¢å…¶ä»–éƒ¨é—¨æ¯”it_progéƒ¨é—¨ä»»æ„å·¥èµ„ä½çš„å‘˜å·¥åï¼Œå·¥ä½œç±»åˆ«å’Œå·¥èµ„

     ```mysql
     SELECT last_name,job_id,salary FROM employees
     WHERE job_id <> 'IT_PROG' AND salary<(
     SELECT MAX(salary) FROM employees 
     WHERE job_id='IT_PROG'
     )
     ```

     â‘¢è¡Œå­æŸ¥è¯¢ï¼ˆå°‘ï¼‰
     æ¡ˆä¾‹ï¼šæŸ¥è¯¢å‘˜å·¥ç¼–å·æœ€å°å¹¶ä¸”å·¥èµ„æœ€é«˜çš„å‘˜å·¥ä¿¡æ¯

     ```mysql
     SELECT * FROM employees
     WHERE (employee_id,salary) = (SELECT MIN(employee_id),MAX(salary) FROM employees)
     ```

  4. **existsåé¢**ï¼ˆç›¸å…³å­æŸ¥è¯¢ï¼‰ æ”¯æŒè¡¨å­æŸ¥è¯¢

     ç»“æœä¸º1æˆ–0ï¼Œ1è¡¨ç¤ºå­˜åœ¨ç»“æœï¼Œ0è¡¨ç¤ºä¸å­˜åœ¨ã€‚
     æ¡ˆä¾‹ï¼šæŸ¥è¯¢æ²¡æœ‰å¥³æœ‹å‹çš„ç”·äºº

     ```mysql
     SELECT * FROM boys bo
     WHERE NOT EXISTS(SELECT * FROM beauty b WHERE b.boyfriend_id=bo.id)
     ```

  **æŒ‰åŠŸèƒ½ä¸åŒï¼š**

  1. **æ ‡é‡å­æŸ¥è¯¢**ï¼ˆç»“æœé›†åªæœ‰ä¸€è¡Œä¸€åˆ—ï¼‰
  2. **åˆ—å­æŸ¥è¯¢**ï¼ˆç»“æœé›†åªæœ‰ä¸€åˆ—å¤šè¡Œï¼‰
  3. **è¡Œå­æŸ¥è¯¢**ï¼ˆç»“æœé›†æœ‰ä¸€è¡Œå¤šåˆ—ï¼‰
  4. **è¡¨å­æŸ¥è¯¢**ï¼ˆç»“æœé›†ï¼Œä¸€èˆ¬å¤šè¡Œå¤šåˆ—ï¼‰

  åˆ†é¡µæŸ¥è¯¢

  åº”ç”¨åœºæ™¯ï¼šå½“è¦æ˜¾ç¤ºçš„[æ•°æ®](https://www.nowcoder.com/jump/super-jump/word?word=%E6%95%B0%E6%8D%AE)ä¸€é¡µæ˜¾ç¤ºä¸å…¨ï¼Œéœ€è¦åˆ†é¡µæäº¤sqlè¯·æ±‚
  ç‰¹ç‚¹ï¼šlimitè¯­å¥æ”¾åœ¨æŸ¥è¯¢è¯­å¥çš„æœ€åï¼›

  **å…¬å¼**ï¼šè¦æ˜¾ç¤ºçš„é¡µæ•°pageï¼Œæ¯é¡µçš„æ¡ç›®æ•°sizeï¼›

  ```mysql
  select æŸ¥è¯¢åˆ—è¡¨ from è¡¨ limit ï¼ˆpage-1)*size,size
  ```

  **è¯­æ³•**ï¼š

  ```mysql
  select æŸ¥è¯¢åˆ—è¡¨ from è¡¨ .... limit offsetï¼Œsize
  ```

  offsetï¼šè¦æ˜¾ç¤ºæ¡ç›®çš„ç´¢å¼• ä»0å¼€å§‹
  sizeï¼šè¦æ˜¾ç¤ºçš„æ¡ç›®ä¸ªæ•°

  æ¡ˆä¾‹ï¼šæŸ¥è¯¢å‰5æ¡å‘˜å·¥ä¿¡æ¯ã€‚

  ```mysql
  SELECT * FROM employees LIMIT 0,5
  ```

  æ¡ˆä¾‹ï¼šæŸ¥è¯¢æœ‰å¥–é‡‘çš„å‘˜å·¥ä¿¡æ¯ï¼Œå¹¶æ˜¾ç¤ºå·¥èµ„è¾ƒé«˜çš„å‰10åã€‚

  ```mysql
  SELECT * FROM employees 
  WHERE commission_pct IS NOT NULL
  ORDER BY salary DESC  LIMIT 0,10
  ```

  æŸ¥è¯¢æ¶‰åŠçš„å…³é”®å­— ----------æ‰§è¡Œé¡ºåº

  select æŸ¥è¯¢åˆ—è¡¨ ------------------â‘¦
  from è¡¨ -----------------------------â‘ 
  è¿æ¥ç±»å‹ **join** è¡¨2-----------------â‘¡
  on è¿æ¥æ¡ä»¶-------------------------â‘¢
  where ç­›é€‰æ¡ä»¶--------------------â‘£
  group by åˆ†ç»„åˆ—è¡¨----------------â‘¤
  having åˆ†ç»„åç­›é€‰----------------â‘¥
  order by [æ’åº]()åˆ—è¡¨-----------------â‘§
  limit åç§»ï¼Œæ¡ç›®æ•° ----------------â‘¨

  è”åˆæŸ¥è¯¢

  å°†å¤šæ¡æŸ¥è¯¢è¯­å¥çš„ç»“æœåˆå¹¶æˆä¸€ä¸ªç»“æœ
  è¯­æ³•ï¼š

  ```mysql
  æŸ¥è¯¢è¯­å¥1 union æŸ¥è¯¢è¯­å¥2 ...*
  ```

  åº”ç”¨åœºæ™¯ï¼šå½“è¦æŸ¥è¯¢çš„ç»“æœæ¥è‡ªå¤šè¡¨ä¸”å¤šè¡¨é—´æ— ç›´æ¥è¿æ¥å…³ç³»
  ç‰¹ç‚¹ï¼š

  â‘ è¦æ±‚å¤šæ¡æŸ¥è¯¢è¯­å¥çš„æŸ¥è¯¢==åˆ—æ•°ä¸€è‡´==
  â‘¡è¦æ±‚å¤šæ¡æŸ¥è¯¢è¯­å¥æŸ¥è¯¢çš„æ¯ä¸€åˆ—çš„==ç±»å‹å’Œé¡ºåº==æœ€å¥½ä¸€è‡´
  â‘¢é»˜è®¤å»é‡ï¼Œä½¿ç”¨**union all**å¯ä»¥åŒ…å«é‡å¤é¡¹
  â‘£å°†ä¸€æ¡æ¯”è¾ƒå¤æ‚çš„æŸ¥è¯¢è¯­å¥æ‹†åˆ†æˆå¤šæ¡



## DML Data Manipulation Language

- **æ’å…¥è¯­å¥**

  **è¯­æ³•**ï¼š

  **æ–¹å¼ä¸€**ï¼š`insert into è¡¨åï¼ˆå­—æ®µ...ï¼‰ values ï¼ˆå€¼...ï¼‰`

  è¦æ±‚æ’å…¥å€¼å¾—ç±»å‹å¿…é¡»ä¸åˆ—å¾—ç±»å‹ä¸€è‡´æˆ–å…¼å®¹
  ä¸ä¸ºnullçš„åˆ—å¿…é¡»æ’å…¥å€¼ï¼Œå¯ä¸ºnullçš„åˆ—å¯ä»¥æ’å…¥nullæˆ–åŒæ—¶çœç•¥å­—æ®µå’Œå€¼
  çœç•¥æ’å…¥åˆ—åé»˜è®¤æ‰€æœ‰åˆ—ï¼Œè€Œä¸”åˆ—çš„é¡ºåºå’Œè¡¨çš„é¡ºåºä¸€è‡´;

  **æ–¹å¼äºŒ**ï¼š`insert into è¡¨å set æ’å…¥åˆ—å = å€¼...`

  **æ¯”è¾ƒ**ï¼šæ–¹å¼ä¸€æ”¯æŒæ’å…¥å¤šè¡Œã€æ–¹å¼ä¸€æ”¯æŒå­æŸ¥è¯¢

- **ä¿®æ”¹è¯­å¥**

  **ä¿®æ”¹å•è¡¨çš„è®°å½•**â­ï¼š`update è¡¨å set åˆ— = æ–°å€¼ï¼Œ... where ç­›é€‰æ¡ä»¶`

  **ä¿®æ”¹å¤šè¡¨çš„è®°å½•**ï¼š

  ```mysql
  update è¡¨1 åˆ«å,è¡¨2 åˆ«å set åˆ—=å€¼... where è¿æ¥æ¡ä»¶ and ç­›é€‰æ¡ä»¶
  update è¡¨1 åˆ«å inner|left|right join è¡¨2 åˆ«å on è¿æ¥æ¡ä»¶ set åˆ—=å€¼.. where ç­›é€‰æ¡ä»¶
  ```

  

- **åˆ é™¤è¯­å¥**

  - **æ–¹å¼ä¸€**ï¼š

    è¯­æ³•ï¼š

    **å•è¡¨çš„åˆ é™¤**â­

    `delete from è¡¨å where ç­›é€‰æ¡ä»¶`

    **å¤šè¡¨çš„åˆ é™¤**

    ```mysql
    delete è¦åˆ é™¤è¡¨çš„åˆ«å 
    from è¡¨1 åˆ«å 
    inner|left|right join è¡¨2 åˆ«å 
    on è¿æ¥æ¡ä»¶ 
    where ç­›é€‰æ¡ä»¶
    ```

  - **æ–¹å¼äºŒ**ï¼š

    **è¯­æ³•**ï¼š`truncate table è¡¨å`ï¼Œæ•´ä¸ªè¡¨å…¨éƒ¨åˆ é™¤

    **åŒºåˆ«**ï¼š
    â‘ delete å¯ä»¥åŠ whereæ¡ä»¶
    â‘¡truncateæ•ˆç‡è¾ƒé«˜
    â‘¢å¦‚æœè¦åˆ é™¤çš„è¡¨ä¸­æœ‰è‡ªå¢é•¿åˆ—ï¼Œå¦‚æœç”¨deleteåˆ é™¤åå†æ’å…¥[æ•°æ®]()ï¼Œå€¼ä»æ–­ç‚¹å¼€å§‹ï¼Œè€Œtruncateåˆ é™¤åå†æ’å…¥[æ•°æ®]()ï¼Œå€¼ä»1å¼€å§‹ã€‚
    â‘£truncateåˆ é™¤æ²¡æœ‰è¿”å›å€¼ï¼Œdeleteæœ‰ã€‚
    â‘¤truncateä¸èƒ½å›æ»šï¼Œdeleteå¯ä»¥ã€‚  

### Mysql æ­£åˆ™è¡¨è¾¾å¼

ä»¥ä¸‹æ˜¯æ¨¡å¼çš„è¡¨æ ¼ï¼Œå…¶å¯ä»¥è¿åŒREGEXPè¿ç®—ç¬¦ä½¿ç”¨ã€‚

| æ¨¡å¼       | ä»€ä¹ˆæ ·çš„æ¨¡å¼åŒ¹é…                  |
| ---------- | --------------------------------- |
| ^          | å¼€å§‹çš„ä¸€ä¸ªå­—ç¬¦ä¸²                  |
| $          | ç»“æŸçš„ä¸€ä¸ªå­—ç¬¦ä¸²                  |
| .          | ä»»æ„å•ä¸ªå­—ç¬¦                      |
| [...]      | æ–¹æ‹¬å·ä¸­åˆ—å‡ºçš„ä»»ä½•å­—ç¬¦            |
| [^...]     | ä»»ä½•å­—ç¬¦æ–¹æ‹¬å·ä¹‹é—´ä¸ä¼šè¢«åˆ—å‡º      |
| p1\|p2\|p3 | äº¤æ›¿;åŒ¹é…çš„ä»»ä½•æ¨¡å¼ p1, p2, æˆ– p3 |
| *          | å‰ä¸€ä¸ªå…ƒç´ çš„é›¶ä¸ªæˆ–å¤šä¸ªå®ä¾‹        |
| +          | å‰é¢å…ƒç´ çš„ä¸€æˆ–å¤šä¸ªå®ä¾‹            |
| {n}        | å‰ä¸€ä¸ªå…ƒç´ çš„nä¸ªå®ä¾‹               |
| {m,n}      | å‰ä¸€ä¸ªå…ƒç´ çš„ m åˆ° n ä¸ªå®ä¾‹        |



## ä¸‰ã€DDL Data Define Language

[æ•°æ®](https://www.nowcoder.com/jump/super-jump/word?word=%E6%95%B0%E6%8D%AE)å®šä¹‰è¯­è¨€ï¼Œæ¶‰åŠåº“å’Œè¡¨çš„ç®¡ç†
åˆ›å»ºï¼šcreate ä¿®æ”¹ï¼šalter åˆ é™¤ï¼šdrop

### 3.1**åº“çš„ç®¡ç†**

**åˆ›å»ºï¼š**

```mysql
create database [if not exists]  åº“å;
```

**ä¿®æ”¹ï¼š**

```mysql
alter database åº“å character set gbk|utf8;
```

**åˆ é™¤ï¼š**

```mysql
drop database if exists åº“å;
```

### 3.2 **è¡¨çš„ç®¡ç†**

**åˆ›å»ºï¼š**

```mysql
 create table [if  not exists]  è¡¨åï¼ˆåˆ—å åˆ—ç±»å‹[é•¿åº¦] [çº¦æŸ]...ï¼‰
```

**ä¿®æ”¹ï¼š**
â‘ ä¿®æ”¹åˆ—å

```mysql
alter table è¡¨å  change [column] æ—§åˆ—å æ–°åˆ—å ç±»å‹ï¼›
```
â‘¡ä¿®æ”¹åˆ—çš„ç±»å‹æˆ–çº¦æŸ
```mysql
alter table è¡¨å modify column åˆ—å æ–°ç±»å‹
```
â‘¢æ·»åŠ åˆ—
```mysql
alter table è¡¨å  add cloumn åˆ—å ç±»å‹ [first|after å­—æ®µå]
```
â‘£åˆ é™¤åˆ—
```mysql
alter table è¡¨å drop cloumn åˆ—å
```
â‘¤ä¿®æ”¹è¡¨å
```mysql
alter table è¡¨å rename to  æ–°å
```

**åˆ é™¤ï¼š**

```mysql
drop table [if exists] è¡¨åï¼›
```

### 3.3 **è¡¨çš„å¤åˆ¶**

ä»…å¤åˆ¶è¡¨çš„ç»“æ„

```mysql
create table ç›®æ ‡ï¼ˆæ–°ï¼‰è¡¨å like æºè¡¨å
```

ä»…å¤åˆ¶è¡¨çš„éƒ¨åˆ†ç»“æ„

```mysql
create table ç›®æ ‡è¡¨å select ç›®æ ‡åˆ—å æºè¡¨å  where 0;
```

å¤åˆ¶è¡¨çš„ç»“æ„+æ•°æ®

```mysql
create table ç›®æ ‡è¡¨å select * from æºè¡¨å
```

å¤åˆ¶è¡¨éƒ¨åˆ†æ•°æ®

```mysql
create table ç›®æ ‡è¡¨å select * from æºè¡¨å where å¤åˆ¶æ¡ä»¶
```

### 3.4 å¸¸è§çš„æ•°æ®ç±»å‹

**ä¸€ . æ•°å€¼å‹**ï¼š
 **æ•´å½¢**
 é»˜è®¤æœ‰ç¬¦å· è®¾ç½®æ— ç¬¦å·ç”¨**unsigned** é›¶å¡«å……**zerofill**ï¼ˆé»˜è®¤æ— ç¬¦å·ï¼‰
 å¦‚æœæ’å…¥å€¼è¶…è¿‡èŒƒå›´ï¼ŒæŠ¥è­¦å‘Šå¹¶æ’å…¥ä¸´ç•Œå€¼
 é•¿åº¦ä»£è¡¨äº†æ˜¾ç¤ºçš„æœ€å¤§å®½åº¦ï¼Œä¸å¤Ÿä¼š0å¡«å……ï¼ˆéœ€è¦æ­é…zerofillï¼‰
 **å°æ•°**ï¼šmè¡¨ç¤ºæ•´æ•°åŠ å°æ•°éƒ¨ä½çš„æ€»é•¿åº¦ï¼Œdè¡¨ç¤ºå°æ•°ç‚¹åä¿ç•™ä½æ•°ï¼Œè¶…è¿‡èŒƒå›´æ˜¾ç¤ºä¸´ç•Œå€¼ï¼Œå¯çœç•¥ï¼Œçœç•¥æ—¶decçš„mé»˜è®¤10ï¼Œdé»˜è®¤0ã€‚
 **æµ®ç‚¹å‹**
 float(m,d)
 double(m,d)
 **å®šç‚¹å‹** ç²¾åº¦è¾ƒé«˜ï¼Œå¦‚è¦æ±‚æ’å…¥æ•°å€¼ç²¾åº¦è¾ƒé«˜å¦‚è´§å¸è¿ç®—è€ƒè™‘æµ®ç‚¹å‹
 dec(m,d)
 **äºŒ . å­—ç¬¦å‹**ï¼š
 è¾ƒçŸ­çš„æ–‡æœ¬ï¼šç”¨æ¥ä¿å­˜MySQLä¸­è¾ƒçŸ­çš„å­—ç¬¦ä¸² Mä¸ºæœ€å¤§å­—ç¬¦æ•°
 **char**(M) å›ºå®šé•¿åº¦å­—ç¬¦ Mä¸º0-255æ•´æ•° Må¯çœç•¥ï¼Œé»˜è®¤1
 **varchar**(M) å¯å˜é•¿åº¦å­—ç¬¦ Mä¸º0-65535æ•´æ•° Mä¸å¯çœç•¥
 **åŒºåˆ«**ï¼šcharæ¯”è¾ƒè€—è´¹ç©ºé—´ï¼Œä½†æ•ˆç‡è¾ƒé«˜ã€‚å¦‚å­˜å‚¨å›ºå®šå±æ€§æ—¶å¯ç”¨charã€‚
 **å…¶ä»–**ï¼š
 binaryå’Œvar binaryç”¨äºä¿å­˜è¾ƒçŸ­äºŒè¿›åˆ¶
 enum ä¿å­˜æšä¸¾ï¼Œä¸åŒºåˆ†å¤§å°å†™ æ’å…¥å¤±è´¥ä¸ºç©º
 set ä¿å­˜é›†åˆï¼Œå’Œenumç±»ä¼¼ï¼ŒåŒºåˆ«ä¸ºå¯é€‰å¤šä¸ª
 è¾ƒé•¿çš„æ–‡æœ¬ï¼š
 textã€
 blobï¼ˆè¾ƒé•¿çš„äºŒè¿›åˆ¶[æ•°æ®]()ï¼‰
 **ä¸‰ . æ—¥æœŸå‹**ï¼š
 dateåªä¿å­˜æ—¥æœŸ
 timeåªä¿å­˜æ—¶é—´
 yearåªä¿å­˜å¹´
 datetimeå’Œtimestampä¿å­˜æ—¥æœŸ+æ—¶é—´
 datetimeå’ŒtimestampåŒºåˆ«ï¼š
 1 timestampæ”¯æŒèŒƒå›´è¾ƒå°
 2 timestamp å’Œå®é™…æ—¶åŒºæœ‰å…³ï¼Œå—MySQLç‰ˆæœ¬å’ŒSQLModeå½±å“å¤§
 3 datetime 8å­—èŠ‚ èŒƒå›´1000-9999
 4 timestamp 4å­—èŠ‚ èŒƒå›´ 1970-2038  

### 3.5 å¸¸è§çº¦æŸ

**å«ä¹‰**ï¼šä¸€ç§é™åˆ¶ï¼Œç”¨äºé™åˆ¶è¡¨ä¸­çš„[æ•°æ®](https://www.nowcoder.com/jump/super-jump/word?word=%E6%95%B0%E6%8D%AE)ï¼Œä¸ºäº†ä¿è¯è¡¨ä¸­çš„[æ•°æ®](https://www.nowcoder.com/jump/super-jump/word?word=%E6%95%B0%E6%8D%AE)çš„å‡†ç¡®å’Œå¯é æ€§
æ·»åŠ çº¦æŸçš„æ—¶æœºï¼šåˆ›å»ºè¡¨æ—¶ã€ä¿®æ”¹è¡¨æ—¶ï¼›

**ä¿®æ”¹è¡¨æ—¶æ·»åŠ çº¦æŸ**ï¼š

```mysql
æ·»åŠ éç©ºçº¦æŸï¼š
alter table è¡¨å modify column åˆ—å ç±»å‹ not null
æ·»åŠ é»˜è®¤çº¦æŸ:
alter table è¡¨å modify column åˆ—å ç±»å‹ default é»˜è®¤å€¼
æ·»åŠ ä¸»é”®çº¦æŸï¼ˆä¸»é”®æ”¯æŒåˆ—çº§çº¦æŸå’Œè¡¨çº§çº¦æŸï¼‰ï¼š
alter table è¡¨å modify column åˆ—å ç±»å‹ primary key
alter table è¡¨å add primary keyï¼ˆåˆ—åï¼‰
æ·»åŠ å”¯ä¸€é”®çº¦æŸï¼ˆå”¯ä¸€é”®æ”¯æŒåˆ—çº§çº¦æŸå’Œè¡¨çº§çº¦æŸï¼‰ï¼š
alter table è¡¨å modify column åˆ—å ç±»å‹ unique 
alter table è¡¨å add uniqueï¼ˆåˆ—åï¼‰
æ·»åŠ å¤–é”®çº¦æŸï¼š
alter table è¡¨å add foreign keyï¼ˆåˆ—åï¼‰  references è¡¨åï¼ˆåˆ—åï¼‰
æ·»åŠ çº§è”åˆ é™¤ï¼šæœ«å°¾æ·»åŠ  on delete cascade  ä»è¡¨ä¸­è¢«åˆ å¤–é”®å€¼æ‰€åœ¨è¡Œè¢«åˆ 
æ·»åŠ çº§è”ç½®ç©ºï¼šæœ«å°¾æ·»åŠ   on delete set null ä»è¡¨ä¸­è¢«åˆ å¤–é”®å€¼ç½®null
```

**ä¿®æ”¹è¡¨æ—¶åˆ é™¤çº¦æŸ**ï¼š

```mysql
åˆ é™¤éç©ºçº¦æŸï¼š
alter table è¡¨å modify column åˆ—å ç±»å‹ null
åˆ é™¤é»˜è®¤çº¦æŸ:
alter table è¡¨å modify column åˆ—å ç±»å‹ 
åˆ é™¤ä¸»é”®çº¦æŸï¼š
alter table è¡¨å drop primary key
åˆ é™¤å”¯ä¸€é”®çº¦æŸï¼š
alter table è¡¨å drop index  é”®å
åˆ é™¤å¤–é”®çº¦æŸï¼š
alter table è¡¨å drop foreign key é”®å
```



## å››ã€[TCL](https://www.nowcoder.com/jump/super-jump/word?word=TCL) Transaction Control Language

### 4.1 äº‹ç‰©

**äº‹åŠ¡**ï¼šä¸€æ¡æˆ–å¤šæ¡sqlè¯­å¥ç»„æˆçš„ä¸€ä¸ªæ‰§è¡Œå•å…ƒï¼Œè¿™ä¸ªæ‰§è¡Œå•å…ƒè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œï¼›

**å­˜å‚¨å¼•æ“**

æ¦‚å¿µï¼šMySQLä¸­[æ•°æ®]()ç”¨å„ç§ä¸åŒæŠ€æœ¯å­˜å‚¨åœ¨æ–‡ä»¶ï¼ˆæˆ–å†…å­˜ï¼‰ä¸­
é€šè¿‡show enginesæŸ¥çœ‹mysqlæ”¯æŒçš„å­˜å‚¨å¼•æ“
åœ¨MySQLä¸­ç”¨çš„æœ€å¤šçš„å­˜å‚¨å¼•æ“æœ‰ï¼šinnodbã€myisamã€memoryç­‰ï¼Œinnodbæ”¯æŒäº‹åŠ¡ï¼Œå…¶ä½™ä¸æ”¯æŒã€‚  

**äº‹åŠ¡çš„å±æ€§ACID**

â‘ **åŸå­æ€§Atomicity**
æŒ‡äº‹åŠ¡æ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ï¼Œäº‹åŠ¡ä¸­çš„æ“ä½œè¦ä¹ˆéƒ½å‘ç”Ÿï¼Œè¦ä¹ˆéƒ½ä¸å‘ç”Ÿ
â‘¡**ä¸€è‡´æ€§Consistency**
äº‹åŠ¡å¿…é¡»ä½¿äº‹åŠ¡ä»ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€å˜æ¢åˆ°å¦ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€
â‘¢**éš”ç¦»æ€§Isolation**
æŒ‡ä¸€ä¸ªäº‹åŠ¡çš„æ‰§è¡Œä¸èƒ½è¢«å…¶ä»–äº‹åŠ¡å¹²æ‰°ï¼Œå³ä¸€ä¸ªäº‹ç‰©å†…éƒ¨çš„æ“ä½œåŠä½¿ç”¨çš„[æ•°æ®]()å¯¹å¹¶å‘çš„å…¶ä»–äº‹åŠ¡æ˜¯éš”ç¦»çš„ï¼Œå¹¶å‘æ‰§è¡Œçš„å„ä¸ªäº‹åŠ¡ä¹‹é—´ä¸èƒ½äº’ç›¸å¹²æ‰°
â‘£**æŒä¹…æ€§Durability**
æŒ‡ä¸€ä¸ªäº‹åŠ¡ä¸€æ—¦è¢«æäº¤ï¼Œå®ƒå¯¹[æ•°æ®]()åº“ä¸­[æ•°æ®]()çš„æ”¹å˜æ˜¯æ°¸ä¹…æ€§çš„  

**äº‹åŠ¡çš„ä½¿ç”¨**

éšå¼äº‹åŠ¡ï¼šäº‹åŠ¡æ²¡æœ‰æ˜æ˜¾çš„å¼€å¯å’Œç»“æŸçš„æ ‡è®°ï¼Œå¦‚insertã€updateã€deleteè¯­å¥
æ˜¾å¼äº‹åŠ¡ï¼šäº‹åŠ¡å…·æœ‰æ˜æ˜¾çš„å¼€å¯å’Œç»“æŸçš„æ ‡è®°ï¼Œå‰æï¼šå¿…é¡»å…ˆè®¾ç½®è‡ªåŠ¨æäº¤åŠŸèƒ½ä¸ºå…³ï¼Œ**set autocommit=0**ã€‚  

```mysql
æ­¥éª¤1ï¼š
    å¼€å¯äº‹åŠ¡ set autocommit=0ï¼› start transactionï¼›ï¼ˆå¯é€‰ï¼‰
æ­¥éª¤2ï¼š
    ç¼–å†™äº‹åŠ¡ä¸­çš„sqlè¯­å¥ï¼ˆselect insert update deleteç­‰ï¼‰
**savepoint** èŠ‚ç‚¹åï¼Œè®¾ç½®ä¿å­˜ç‚¹
**rollback to** èŠ‚ç‚¹åï¼Œå¯å›æ»šåˆ°ä¿å­˜ç‚¹
æ­¥éª¤3ï¼š
    ç»“æŸäº‹åŠ¡ commitï¼›æäº¤äº‹åŠ¡ rollback å›æ»šäº‹åŠ¡ï¼›
```

**deleteå’Œtruncateåœ¨äº‹åŠ¡ä½¿ç”¨æ—¶çš„åŒºåˆ«**
deleteå¯æˆåŠŸå›æ»šï¼Œtruncateå›æ»šåè¡¨ä»åˆ é™¤ã€‚

**éš”ç¦»çº§åˆ«**

- **è„è¯»**ï¼šå¯¹äºä¸¤ä¸ªäº‹åŠ¡T1å’ŒT2ï¼ŒT1è¯»å–äº†å·²è¢«T2 **æ›´æ–°ä½†è¿˜æ²¡æœ‰æäº¤** çš„å­—æ®µï¼Œä¹‹åè‹¥T2å›æ»šï¼ŒT1è¯»å–çš„å†…å®¹æ˜¯ä¸´æ—¶ä¸”æ— æ•ˆçš„ã€‚

- **ä¸å¯é‡å¤è¯»**ï¼šT1è¯»å–äº†ä¸€ä¸ªå­—æ®µï¼ŒT2 **æ›´æ–°è¯¥å­—æ®µå¹¶æäº¤** ï¼ŒT1å†æ¬¡è¯»å–åŒä¸€å­—æ®µï¼Œå€¼ä¸åŒ

- **å¹»è¯»**ï¼šT1è¯»å–äº†ä¸€ä¸ªå­—æ®µï¼ŒT2åœ¨è¯¥è¡¨ä¸­æ’å…¥äº†ä¸€äº›æ–°è¡Œï¼Œä¹‹åT1å†è¯»å–åŒä¸€ä¸ªè¡¨ä¼šå¤šå‡ºå‡ è¡Œï¼›

  Oracleæ”¯æŒä¸¤ä¸ªéš”ç¦»çº§åˆ«ï¼šè¯»å·²æäº¤ã€å¯ä¸²è¡ŒåŒ–ã€‚

  MySQLæ”¯æŒå››ä¸ªéš”ç¦»çº§åˆ«ï¼šè¯»æœªæäº¤ï¼ˆå­˜åœ¨è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»ï¼‰ã€è¯»å·²æäº¤ï¼ˆè§£å†³è„è¯»ï¼‰ã€å¯é‡å¤è¯»ï¼ˆé»˜è®¤ï¼Œè§£å†³è„è¯»ï¼Œä¸å¯é‡å¤è¯»ï¼‰ã€å¯ä¸²è¡ŒåŒ–ï¼ˆè§£å†³æ‰€æœ‰å¹¶å‘é—®é¢˜ï¼Œä½†æ•ˆç‡è¾ƒä½ï¼‰

  ```mysql
  è®¾ç½®å½“å‰éš”ç¦»çº§åˆ«ï¼š**set transaction isolation level** çº§åˆ«
  è®¾ç½®å…¨å±€éš”ç¦»çº§åˆ«ï¼š**set global transaction isolation level** çº§åˆ«
  
  ```

### 4.2 è§†å›¾

**å«ä¹‰**ï¼šè™šæ‹Ÿè¡¨ï¼Œå’Œæ™®é€šçš„è¡¨ä¸€æ ·ä½¿ç”¨ï¼ŒMySQL5.0.1å‡ºç°çš„æ–°ç‰¹æ€§ï¼Œæ˜¯é€šè¿‡è¡¨åŠ¨æ€ç”Ÿæˆçš„[æ•°æ®]()ï¼Œ==åªä¿å­˜sqlé€»è¾‘ï¼Œä¸ä¿å­˜æŸ¥è¯¢ç»“æœ==ï¼›
åº”ç”¨åœºæ™¯ï¼šå¤šä¸ªåœ°æ–¹ç”¨åˆ°åŒæ ·çš„æŸ¥è¯¢ç»“æœã€è¯¥æŸ¥è¯¢ç»“æœçš„sqlè¯­å¥è¾ƒå¤æ‚
å¥½å¤„ï¼šé‡ç”¨sqlè¯­å¥ï¼Œç®€åŒ–å¤æ‚sqlæ“ä½œï¼Œä¿æŠ¤[æ•°æ®]()æé«˜å®‰å…¨æ€§  

- **åˆ›å»ºè§†å›¾**
  `create view è§†å›¾å as æŸ¥è¯¢è¯­å¥`

- **ä¿®æ”¹è§†å›¾**

  ```mysql
  æ–¹å¼ä¸€ï¼šcreate or replace view è§†å›¾å as æŸ¥è¯¢è¯­å¥
  æ–¹å¼äºŒï¼šalter view è§†å›¾å as æŸ¥è¯¢è¯­å¥
  ```

  å…·å¤‡ä»¥ä¸‹ç‰¹ç‚¹çš„è§†å›¾ä¸å…è®¸æ›´æ”¹ï¼š
   â‘ åŒ…å«ï¼šåˆ†ç»„å‡½æ•° distinct group byã€havingã€unionã€union allã€join
   â‘¡å¸¸é‡è§†å›¾
   â‘¢selectåŒ…å«å­æŸ¥è¯¢ã€fromåè·Ÿä¸èƒ½æ›´æ–°çš„è§†å›¾ã€whereå­—å¥çš„å­æŸ¥è¯¢å¼•ç”¨äº†fromå­—å¥ä¸­çš„è¡¨  

- **åˆ é™¤è§†å›¾**

  `drop view è§†å›¾å...`

- **æŸ¥çœ‹è§†å›¾**

  ```mysql
  desc è§†å›¾åï¼›
  show create view è§†å›¾åï¼›
  ```

- **è§†å›¾å’Œè¡¨çš„åŒºåˆ«**

  è§†å›¾åˆ›å»ºç”¨create viewï¼ŒåŸºæœ¬ä¸å ç”¨å®é™…ç‰©ç†ç©ºé—´ï¼Œåªæ˜¯ä¿å­˜sqlé€»è¾‘ï¼Œä¸€èˆ¬ä¸èƒ½å¢åˆ æ”¹
  è¡¨åˆ›å»ºç”¨create tableï¼Œå ç”¨å®é™…ç‰©ç†ç©ºé—´ï¼Œä¿å­˜äº†å…·ä½“[æ•°æ®](https://www.nowcoder.com/jump/super-jump/word?word=%E6%95%B0%E6%8D%AE)

### 4.3 å˜é‡

- **ç³»ç»Ÿå˜é‡**
  å˜é‡ç”±ç³»ç»Ÿæä¾›ï¼Œä¸ç”¨è‡ªå®šä¹‰
  æŸ¥çœ‹æ‰€æœ‰ç³»ç»Ÿå˜é‡ï¼š
  `show global | [session] variablesï¼›`
  æŸ¥çœ‹æ»¡è¶³æ¡ä»¶çš„éƒ¨åˆ†ç³»ç»Ÿå˜é‡ï¼š
  `show global | [session] variables like æ¡ä»¶ï¼›`
  æŸ¥çœ‹æŸä¸ªæŒ‡å®šç³»ç»Ÿå˜é‡ï¼š
  `select @@global | [session] .ç³»ç»Ÿå˜é‡å`
  ä¸ºç³»ç»Ÿå˜é‡èµ‹å€¼ï¼š
  `set @@global | [session] .ç³»ç»Ÿå˜é‡å = å€¼ï¼›`
  ä¸å†™é»˜è®¤ä¸ºsession
  â‘ å…¨å±€å˜é‡
  æœåŠ¡å™¨å±‚é¢ï¼Œå¿…é¡»æ‹¥æœ‰superæƒé™æ‰èƒ½ä¸ºç³»ç»Ÿå˜é‡èµ‹å€¼
  ä½œç”¨åŸŸï¼šæœåŠ¡å™¨æ¯æ¬¡å¯åŠ¨ä¸ºæ‰€æœ‰å…¨å±€å˜é‡èµ‹åˆå§‹å€¼ï¼Œé’ˆå¯¹æ‰€æœ‰ä¼šè¯æœ‰æ•ˆï¼Œä¸èƒ½è·¨é‡å¯
  â‘¡ä¼šè¯å˜é‡
  æœåŠ¡å™¨ä¸ºæ¯ä¸€ä¸ªè¿æ¥çš„å®¢æˆ·ç«¯éƒ½æä¾›äº†ç³»ç»Ÿå˜é‡
  ä½œç”¨åŸŸï¼šä»…é’ˆå¯¹å½“å‰ä¼šè¯ï¼ˆè¿æ¥ï¼‰æœ‰æ•ˆ  

- **è‡ªå®šä¹‰å˜é‡**
  å£°æ˜
  èµ‹å€¼
  ä½¿ç”¨ï¼ˆæŸ¥çœ‹ï¼Œæ¯”è¾ƒï¼Œè¿ç®—ï¼‰

  - â‘ **ç”¨æˆ·å˜é‡**
    ä½œç”¨åŸŸï¼šé’ˆå¯¹å½“å‰ä¼šè¯ï¼ˆè¿æ¥ï¼‰æœ‰æ•ˆ
    åº”ç”¨åœ¨ä»»ä½•åœ°æ–¹

    ```mysql
      - 1 å£°æ˜å¹¶åˆå§‹åŒ–
      set @ç”¨æˆ·å˜é‡å = å€¼
      set @ç”¨æˆ·å˜é‡åï¼š=å€¼
      select @ç”¨æˆ·å˜é‡åï¼š=å€¼
      - 2 èµ‹å€¼
      set @ç”¨æˆ·å˜é‡å = å€¼
      set @ç”¨æˆ·å˜é‡åï¼š=å€¼
      select @ç”¨æˆ·å˜é‡åï¼š=å€¼
      select å­—æ®µ into @å˜é‡å from è¡¨
      - 3 æŸ¥çœ‹
      select @ç”¨æˆ·å˜é‡å
    ```

  - â‘¡**å±€éƒ¨å˜é‡**
    ä½œç”¨åŸŸï¼šä»…åœ¨å®šä¹‰å®ƒçš„begin endä¸­æœ‰æ•ˆ
    åº”ç”¨åœ¨begin endä¸­çš„ç¬¬ä¸€å¥è¯

    ```mysql
    å£°æ˜ï¼š
    	declare å˜é‡å ç±»å‹
    	declare å˜é‡å ç±»å‹ [default å€¼]
    èµ‹å€¼ï¼š    
    set å˜é‡å = å€¼ï¼›
    set å˜é‡åï¼š=å€¼
    select @ç”¨æˆ·å˜é‡åï¼š=å€¼ï¼š
    select å­—æ®µ into å˜é‡å from è¡¨ï¼›
    æŸ¥çœ‹ï¼š
    select å˜é‡åï¼›
    ```

### 4.4 å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°

- å­˜å‚¨è¿‡ç¨‹
  å«ä¹‰ï¼šä¸€ç»„é¢„å…ˆç¼–è¯‘å¥½çš„sqlè¯­å¥çš„é›†åˆ
  å¥½å¤„ï¼šå‡å°‘äº†ç¼–è¯‘æ¬¡æ•°å¹¶ä¸”å‡å°‘äº†å’Œ[æ•°æ®](https://www.nowcoder.com/jump/super-jump/word?word=%E6%95%B0%E6%8D%AE)åº“æœåŠ¡å™¨çš„è¿æ¥æ¬¡æ•°ï¼Œæé«˜äº†æ•ˆç‡

  - **åˆ›å»º**

    ```mysql
    create procedure å­˜å‚¨è¿‡ç¨‹åï¼ˆå‚æ•°åˆ—è¡¨ï¼‰
    begin
        å­˜å‚¨è¿‡ç¨‹ä½“ï¼ˆä¸€ç»„sqlè¯­å¥ï¼‰
    end
    ```

    æ³¨æ„ï¼šå‚æ•°åˆ—è¡¨åŒ…æ‹¬å‚æ•°æ¨¡å¼ å‚æ•°å å‚æ•°ç±»å‹
    1.å‚æ•°æ¨¡å¼ï¼š
     IN ä»£è¡¨å‚æ•°å¯ä»¥ä½œä¸ºè¾“å…¥ï¼Œè¯¥å‚æ•°éœ€è¦è°ƒç”¨æ–¹ä¼ å…¥å€¼ INå¯çœç•¥
     OUT è¯¥å‚æ•°å¯ä»¥ä½œä¸ºè¾“å‡ºï¼Œå¯ä»¥ä½œä¸ºè¿”å›å€¼
     INOUT è¯¥å‚æ•°æ—¢å¯ä»¥ä½œä¸ºè¾“å…¥ï¼Œåˆå¯ä»¥ä½œä¸ºè¾“å‡º
     2.å¦‚æœå­˜å‚¨è¿‡ç¨‹é‡Œä»…æœ‰ä¸€å¥è¯ï¼Œå¯ä»¥çœç•¥begin end
     3.å­˜å‚¨è¿‡ç¨‹ä½“çš„æ¯æ¡è¯­å¥ç”¨ï¼›ç»“å°¾ï¼Œå­˜å‚¨è¿‡ç¨‹çš„ç»“å°¾å¯ä»¥ä½¿ç”¨delimiteré‡è®¾ ;

  - **è°ƒç”¨**

    callå­˜å‚¨è¿‡ç¨‹åï¼ˆå®å‚åˆ—è¡¨ï¼‰

    ```mysql
    æ— å‚å­˜å‚¨è¿‡ç¨‹æ¡ˆä¾‹ï¼šå‘adminè¡¨æ’å…¥5æ¡è®°å½•
    DELIMITER $
    CREATE PROCEDURE myp2()
    BEGIN
        INSERT INTO admin(username,PASSWORD) VALUES('lily',2211),('jack',2211),('sad',2211),('tom',2211),('sts',2211);    
    END $
    
    CALL myp2()$
    ```

==æ²¡çœ‹å®Œ==

### 4.5 æµç¨‹æ§åˆ¶ç»“æ„

- **é¡ºåºç»“æ„**ï¼šç¨‹åºä»ä¸Šå¾€ä¸‹ä¾æ¬¡æ‰§è¡Œ
- **åˆ†æ”¯ç»“æ„**ï¼šç¨‹åºä»ä¸¤æ¡æˆ–å¤šæ¡è·¯å¾„ä¸­é€‰æ‹©ä¸€æ¡æ‰§è¡Œ

**1. ifå‡½æ•°** 

èƒ½å®ç°ç®€å•çš„åŒåˆ†æ”¯
è¯­æ³•ï¼š`select ifï¼ˆè¡¨è¾¾å¼1ï¼Œè¡¨è¾¾å¼2ï¼Œè¡¨è¾¾å¼3ï¼‰`
å¦‚æœè¡¨è¾¾å¼1æˆç«‹ï¼Œåˆ™è¿”å›è¡¨è¾¾å¼2çš„å€¼ï¼Œå¦åˆ™è¿”å›è¡¨è¾¾å¼3çš„å€¼
åº”ç”¨ï¼šä»»ä½•åœ°æ–¹

**2. caseç»“æ„**

```mysql
    æƒ…å†µ1ï¼šç±»ä¼¼äºswitch ä¸€èˆ¬ç”¨äºç­‰å€¼åˆ¤æ–­
    case å˜é‡|è¡¨è¾¾å¼|å­—æ®µ
    when è¦åˆ¤æ–­çš„å€¼ then è¿”å›çš„å€¼1|è¯­å¥1;
    when è¦åˆ¤æ–­çš„å€¼ then è¿”å›çš„å€¼2|è¯­å¥2;
    ...
    else è¿”å›çš„å€¼n
    end case;

    æƒ…å†µ2ï¼šç±»ä¼¼å¤šé‡if ä¸€èˆ¬ç”¨äºå®ç°åŒºé—´åˆ¤æ–­
    case 
    when è¦åˆ¤æ–­çš„æ¡ä»¶1 then è¿”å›çš„å€¼1|è¯­å¥1;
    when è¦åˆ¤æ–­çš„æ¡ä»¶2 then è¿”å›çš„å€¼2|è¯­å¥2;
    ...
    else è¿”å›çš„å€¼n
    end case;
    ç‰¹ç‚¹ï¼š
    1 æ—¢èƒ½ä½œä¸ºè¡¨è¾¾å¼åµŒå¥—åœ¨å…¶ä»–è¯­å¥ä¸­ä½¿ç”¨ï¼Œå¯åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨
    2 å¦‚æœä½œä¸ºç‹¬ç«‹è¯­å¥åªèƒ½æ”¾åœ¨begin endä¸­
    3 å¦‚æœwhenä¸­çš„å€¼æˆ–æ¡ä»¶æˆç«‹ï¼Œæ‰§è¡Œå¯¹åº”thenåé¢çš„è¯­å¥ï¼Œå¹¶ç»“æŸcaseï¼Œ
    å¦‚æœéƒ½ä¸æ»¡è¶³æ‰§è¡Œelseä¸­è¯­å¥ï¼Œelseå¯ä»¥çœç•¥ï¼Œå¦‚æœelseçœç•¥å¹¶ä¸”æ‰€æœ‰æ¡ä»¶éƒ½ä¸æ»¡è¶³ï¼Œè¿”å›null

    ä¾‹ï¼šåˆ›å»ºå­˜å‚¨è¿‡ç¨‹ï¼Œæ ¹æ®ä¼ å…¥çš„æˆç»©æ˜¾ç¤ºå¯¹åº”ç­‰çº§
    DELIMITER $
    create procedure test(in score int)
    begin
        case
        when score>=90 and score<=100 then select 'A';
        when score>=80 then select 'B';
        when score>=60 then select 'C';
        else select 'D';
        end case;
    end $
```

**3. ifç»“æ„**

å®ç°å¤šé‡åˆ†æ”¯

è¯­æ³•ï¼š

```mysql
if æ¡ä»¶1 then è¯­å¥1;
elseif æ¡ä»¶2 then è¯­å¥2;
...
[else è¯­å¥n;]
end if;
åªèƒ½ç”¨äºbegin endä¸­


ä¾‹ï¼šåˆ›å»ºå‡½æ•°ï¼Œæ ¹æ®ä¼ å…¥çš„æˆç»©æ˜¾ç¤ºå¯¹åº”ç­‰çº§
    DELIMITER $
    create function fun(score int) returns char
    begin
        if score>=90 and score<=100 then return 'A';
        elseif score>=80 then return 'B';
        elseif score>=60 then return 'C';
        else return 'D';
        end if;
    end $

```

- **å¾ªç¯ç»“æ„**ï¼šç¨‹åºåœ¨æ»¡è¶³ä¸€å®šæ¡ä»¶çš„åŸºç¡€ä¸Šé‡å¤æ‰§è¡Œä¸€æ®µä»£ç 

  **åªèƒ½æ”¾åœ¨begin endä¸­**
  åˆ†ç±»ï¼š
  whileã€loopã€repeat
  å¾ªç¯æ§åˆ¶ï¼š
  iterate ç±»ä¼¼äºcontinue ç»“æŸæœ¬æ¬¡å¾ªç¯ï¼Œç»§ç»­ä¸‹ä¸€æ¬¡
  leave ç±»ä¼¼äºbreakï¼Œç»“æŸå½“å‰æ‰€åœ¨å¾ªç¯  

  ```mysql
  1. while
  [æ ‡ç­¾:]while å¾ªç¯æ¡ä»¶ do
      å¾ªç¯ä½“;
  end while [æ ‡ç­¾];
  2. loop
  [æ ‡ç­¾:]loop
       å¾ªç¯ä½“;
   end loop[æ ‡ç­¾];
  3. repeat
  [æ ‡ç­¾:]repeat
       å¾ªç¯ä½“;
   until ç»“æŸå¾ªç¯çš„æ¡ä»¶;
   end repeat[æ ‡ç­¾];
  
  whileæ¡ˆä¾‹ï¼šæ‰¹é‡æ’å…¥ï¼Œæ ¹æ®è®¾å®šçš„æ¬¡æ•°æ’å…¥adminè¡¨å¤šæ¡è®°å½•
  create procedure test(in time int)
  begin
      declare i int default 1;
      while i<=time do
          insert into admin(username,password) values (concat('jon',i),'123');
          set i=i+1;
      end while;
  end$
  
  leaveæ¡ˆä¾‹ï¼šæ‰¹é‡æ’å…¥ï¼Œæ ¹æ®è®¾å®šçš„æ¬¡æ•°æ’å…¥adminè¡¨å¤šæ¡è®°å½•ï¼Œæ¬¡æ•°å¤§äº20åˆ™åœæ­¢
  create procedure test(in time int)
  begin 
      declare i int default 1;
      a:while i<=time do
          insert into admin(username,password) values (concat('jon',i),'123');
          if i>20 then leave a;
          end if;
          set i=i+1;
      end while a;
  end$
  
  iterateæ¡ˆä¾‹ï¼šæ‰¹é‡æ’å…¥ï¼Œåªæ’å…¥å¶æ•°è®°å½•
  create procedure test(in time int)
  begin 
      declare i int default 0;
      a:while i<=time do
          set i=i+1;
          if mod (i,2)<>0 then iterate a;
          end if;
          insert into admin(username,password) values (concat('jon',i),'123');
      end while a;
  end$
  ```

  **ä¸‰ç§å¾ªç¯çš„åŒºåˆ«**ï¼š
  while å…ˆåˆ¤æ–­åæ‰§è¡Œ
  repeat å…ˆæ‰§è¡Œååˆ¤æ–­
  loop æ²¡æœ‰æ¡ä»¶çš„æ­»å¾ªç¯

  ```mysql
  ä¹ é¢˜ï¼šå·²çŸ¥è¡¨stringcontentï¼Œå­—æ®µ idè‡ªå¢é•¿ content varcharï¼ˆ20ï¼‰å‘è¯¥è¡¨æ’å…¥æŒ‡å®šä¸ªæ•°çš„éšæœºå­—ç¬¦ä¸²
  
  CREATE TABLE stringcontent(
      id INT PRIMARY KEY AUTO_INCREMENT,
      content VARCHAR(20)
  );
  
  DELIMITER $ 
  CREATE PROCEDURE randstr(IN num INT)
  BEGIN
      DECLARE i INT DEFAULT 1;
      DECLARE str VARCHAR(26) DEFAULT 'abcdefghijklmnopqrstuvwxyz';
      DECLARE startindex INT DEFAULT 1;
      DECLARE len INT DEFAULT 1;
      WHILE i<=num DO
          SET len=FLOOR(RAND()*(20-startindex+1)+1);
          SET startindex=FLOOR(RAND()*26+1);
          INSERT INTO stringcontent(content) VALUES(SUBSTR(str,startindex,len));
          SET i=i+1;
      END WHILE;
  END $
  ```

  